# æ¸¬è©¦è¦†è“‹ç‡ç­–ç•¥èˆ‡æ”¹é€²è¨ˆç•«

> **ç›®çš„**: å»ºç«‹åŸºæ–¼æ¥­ç•Œæ¨™æº–çš„æ¸¬è©¦è¦†è“‹ç‡ç­–ç•¥ï¼Œå¹³è¡¡å“è³ªèˆ‡é–‹ç™¼æ•ˆç‡

**å‰µå»ºæ™‚é–“**: 2025-11-22
**æœ€å¾Œæ›´æ–°**: 2025-11-22
**ç‰ˆæœ¬**: v1.0
**ç‹€æ…‹**: âœ… å·²å®Œæˆ

---

## æ¥­ç•Œæ¨™æº–åŸºæº–

### Google æ¨™æº– (2025)

| è¦†è“‹ç‡ | è©•ç´š                   | èªªæ˜           |
| ------ | ---------------------- | -------------- |
| 60%    | å¯æ¥å— (Acceptable)    | åŸºæœ¬å“è³ªé–€æª»   |
| 75%    | å€¼å¾—è®šæš (Commendable) | è‰¯å¥½çš„æ¸¬è©¦å¯¦è¸ |
| 90%    | å“è¶Š (Exemplary)       | å„ªç§€çš„æ¸¬è©¦è¦†è“‹ |

### ä¸€èˆ¬ä¼æ¥­æ¨™æº–

- **å¸¸è¦‹é–€æª»**: 80% ä½œç‚º CI/CD é–€æª»
- **å»ºè­°ç­–ç•¥**: ç›®æ¨™ 80%, é–€æª» 70% (10% å®‰å…¨è£•åº¦)
- **IEEE æ¨™æº–**: é—œéµç³»çµ±è¦æ±‚ 100% statement + branch coverage

---

## ç•¶å‰ç‹€æ…‹ (2025-11-22)

### å¯¦éš›è¦†è“‹ç‡

```yaml
Statements: 81.56% âœ…
Branches: 71.93% âš ï¸
Functions: 82.56% âœ…
Lines: 83.00% âœ…
```

### CI é–€æª»è¨­å®š

```typescript
// vitest.config.ts
thresholds: {
  statements: 81,  // ç•¶å‰: 81.56%
  branches: 71,    // ç•¶å‰: 71.93%
  functions: 82,   // ç•¶å‰: 82.56%
  lines: 83,       // ç•¶å‰: 83%
}
```

### è©•ä¼°çµæœ

| æŒ‡æ¨™       | é–€æª» | å¯¦éš›   | å°æ¯”æ¥­ç•Œ         | ç‹€æ…‹    |
| ---------- | ---- | ------ | ---------------- | ------- |
| Statements | 81%  | 81.56% | è¶…è¶Š Google 75%+ | âœ… å„ªç§€ |
| Branches   | 71%  | 71.93% | æ¥è¿‘ Google 75%  | âš ï¸ è‰¯å¥½ |
| Functions  | 82%  | 82.56% | è¶…è¶Š Google 75%+ | âœ… å„ªç§€ |
| Lines      | 83%  | 83%    | è¶…è¶Š Google 75%+ | âœ… å„ªç§€ |

**ç¸½é«”è©•åƒ¹**: âœ… **ç¬¦åˆæ¥­ç•Œæ¨™æº–ï¼Œå“è³ªè‰¯å¥½**

---

## æ”¹é€²è¨ˆç•«

### çŸ­æœŸç›®æ¨™ (Q1 2025)

**ç›®æ¨™**: æå‡ branches è¦†è“‹ç‡è‡³ 73%

```yaml
å„ªå…ˆè™•ç†:
  - MultiConverter.tsx: åˆ†æ”¯è¦†è“‹ç‡ 60.22%
  - CalculatorKeyboard.tsx: åˆ†æ”¯è¦†è“‹ç‡ 0%
  - useCalculator.ts: åˆ†æ”¯è¦†è“‹ç‡ 64.58%

é æœŸæå‡: 71.93% â†’ 73%
```

### ä¸­æœŸç›®æ¨™ (Q2 2025)

**ç›®æ¨™**: å…¨é¢æå‡è‡³ 75%+ (Google è®šæšç´šåˆ¥)

```yaml
Statements: 81% â†’ 84%
Branches: 71% â†’ 76%
Functions: 82% â†’ 84%
Lines: 83% â†’ 85%
```

### é•·æœŸç›®æ¨™ (Q3 2025)

**ç›®æ¨™**: é”æˆ 86/80/86/86% (æ¥è¿‘å“è¶Šæ¨™æº–)

```yaml
Statements: 84% â†’ 86%
Branches: 76% â†’ 80%
Functions: 84% â†’ 86%
Lines: 85% â†’ 86%
```

---

## æŠ€è¡“ç­–ç•¥

### ç­–ç•¥ 1: é˜²é€€åŒ–é–€æª» (å·²å¯¦æ–½)

**åŸç†**: é–€æª»ç•¥ä½æ–¼ç•¶å‰å€¼ï¼Œé˜²æ­¢è¦†è“‹ç‡å€’é€€

```typescript
// ç•¶å‰ç­–ç•¥ï¼šå¯¦éš›å€¼ - 0.5%
statements: 81,  // å¯¦éš› 81.56%
branches: 71,    // å¯¦éš› 71.93%
functions: 82,   // å¯¦éš› 82.56%
lines: 83,       // å¯¦éš› 83%
```

**å„ªé»**:

- âœ… å…è¨±å°å¹…æ³¢å‹• (0.5% ç·©è¡)
- âœ… é˜²æ­¢è¦†è“‹ç‡å¤§å¹…ä¸‹é™
- âœ… ä¸æœƒå› å°æ”¹å‹•å°è‡´ CI å¤±æ•—

### ç­–ç•¥ 2: è‡ªå‹•é–€æª»æ›´æ–° (å»ºè­°ä¸‹éšæ®µ)

**Vitest 4.0 æ–°åŠŸèƒ½**: `thresholdAutoUpdate`

```typescript
coverage: {
  thresholds: {
    autoUpdate: true, // ğŸ†• è‡ªå‹•æå‡é–€æª»
    statements: 81,
    branches: 71,
    functions: 82,
    lines: 83,
  },
}
```

**å„ªé»**:

- âœ… è‡ªå‹•æå‡é–€æª»è‡³ç•¶å‰è¦†è“‹ç‡
- âœ… ç¢ºä¿è¦†è“‹ç‡åªå¢ä¸æ¸›
- âœ… ç„¡éœ€æ‰‹å‹•ç¶­è­·é–€æª»å€¼

**å¯¦æ–½æ™‚æ©Ÿ**: Q2 2025 (branches é”åˆ° 75% å¾Œ)

### ç­–ç•¥ 3: çµ•å°æ•¸å€¼é–€æª» (é€²éšç­–ç•¥)

**åŸç†**: é™åˆ¶æœªè¦†è“‹é …ç›®çš„çµ•å°æ•¸é‡

```typescript
coverage: {
  thresholds: {
    // è² æ•¸ = æœ€å¤šå…è¨±çš„æœªè¦†è“‹æ•¸é‡
    statements: -500,  // æœ€å¤š 500 å€‹æœªè¦†è“‹ statement
    branches: -300,    // æœ€å¤š 300 å€‹æœªè¦†è“‹ branch
    functions: -100,   // æœ€å¤š 100 å€‹æœªè¦†è“‹ function
    lines: -400,       // æœ€å¤š 400 å€‹æœªè¦†è“‹ line
  },
}
```

**å„ªé»**:

- âœ… å‡çµæŠ€è¡“å‚µæ•¸é‡
- âœ… æ–°ä»£ç¢¼å¿…é ˆæœ‰æ¸¬è©¦
- âœ… å¼·åˆ¶æ¼¸é€²å¼æ”¹é€²

**å¯¦æ–½æ™‚æ©Ÿ**: Q3 2025 (é”æˆ 80%+ å¾Œè€ƒæ…®)

---

## æ’é™¤é …ç›®æ¸…å–®

### åˆç†æ’é™¤ (å·²å¯¦æ–½)

```typescript
exclude: [
  // PWA ç›¸é—œ (éœ€è¦ Service Worker ç’°å¢ƒ)
  'src/utils/pushNotifications.ts',
  'src/utils/versionChecker.ts',
  'src/utils/swUtils.ts',
  'src/components/UpdatePrompt.tsx',
  'src/components/AutoUpdateToast.tsx',

  // ç€è¦½å™¨å°ˆç”¨ (éœ€è¦çœŸå¯¦ DOM)
  'src/utils/webVitals.ts',
  'src/trusted-types-bootstrap.ts',

  // å¤–éƒ¨æœå‹™æ•´åˆ
  'src/utils/sentry.ts',

  // E2E æ¸¬è©¦è¦†è“‹
  'src/App.tsx',
  'src/pages/**/*.tsx',
  'src/components/SwipeTooltip.tsx',

  // ç„¡å¯åŸ·è¡Œä»£ç¢¼
  'src/**/types.ts',
  'src/vite-env.d.ts',
];
```

**æ’é™¤åŸå‰‡**:

1. éœ€è¦ç‰¹æ®Šç’°å¢ƒæ‰èƒ½æ¸¬è©¦çš„æ¨¡çµ„ (PWA, Browser APIs)
2. å¤–éƒ¨æœå‹™æ•´åˆ (Sentry, Analytics)
3. ç”± E2E æ¸¬è©¦è¦†è“‹çš„ UI çµ„ä»¶
4. ç´”é¡å‹å®šç¾©æ–‡ä»¶

---

## æˆåŠŸæŒ‡æ¨™

### é—œéµç¸¾æ•ˆæŒ‡æ¨™ (KPI)

```yaml
âœ… éšæ®µ 1 å®Œæˆ (2025-11-22):
  - 405/405 tests é€šé
  - è¦†è“‹ç‡é”æ¨™ (81/71/82/83%)
  - ç¬¦åˆæ¥­ç•Œæ¨™æº–

ğŸ¯ éšæ®µ 2 ç›®æ¨™ (Q1 2025):
  - branches æå‡è‡³ 73%
  - æ–°å¢ 20+ æ¸¬è©¦æ¡ˆä¾‹
  - å•Ÿç”¨ thresholdAutoUpdate

ğŸ¯ éšæ®µ 3 ç›®æ¨™ (Q2 2025):
  - å…¨é¢é”åˆ° Google è®šæšç´šåˆ¥ (75%+)
  - è¦†è“‹ç‡æå‡è‡³ 84/76/84/85%

ğŸ¯ éšæ®µ 4 ç›®æ¨™ (Q3 2025):
  - æ¥è¿‘å“è¶Šæ¨™æº– (86/80/86/86%)
  - è€ƒæ…®å•Ÿç”¨çµ•å°æ•¸å€¼é–€æª»
```

---

## åƒè€ƒè³‡æ–™

### æ¥­ç•Œæ¨™æº–æ–‡ç»

1. **Google Testing Blog** - Code Coverage Best Practices (2020)
   - 60% acceptable, 75% commendable, 90% exemplary
   - https://testing.googleblog.com/2020/08/code-coverage-best-practices.html

2. **Atlassian** - What is Code Coverage?
   - 80% ç‚ºä¼æ¥­å¸¸è¦‹æ¨™æº–
   - https://www.atlassian.com/continuous-delivery/software-testing/code-coverage

3. **IEEE Standard** - Software Unit Testing
   - é—œéµç³»çµ±è¦æ±‚ 100% statement + branch coverage

### Vitest æ–‡æª”

1. **Vitest Coverage Guide** (v4.0)
   - https://vitest.dev/guide/coverage
   - thresholdAutoUpdate åŠŸèƒ½èªªæ˜

2. **GitHub Issue #1241** - Coverage threshold bumper
   - https://github.com/vitest-dev/vitest/issues/1241
   - è‡ªå‹•æå‡é–€æª»çš„éœ€æ±‚è¨è«–

---

## é™„éŒ„ï¼šæ­·å²è¨˜éŒ„

### 2025-11-22: æŠ€è¡“å‚µæ¸…é™¤

**æ”¹é€²é …ç›®**:

- exchangeRateCalculation.ts: 13.55% â†’ 96.61% (+83.06%)
- Logger ç³»çµ±æ•´åˆå®Œæˆ
- 391/391 tests é€šé

**è¦†è“‹ç‡è®ŠåŒ–**:

- Statements: æå‡è‡³ 81.56%
- Branches: æå‡è‡³ 71.93%
- Functions: æå‡è‡³ 82.56%
- Lines: æå‡è‡³ 83%

**æ±ºç­–ä¾æ“š**:

- Linus å¯¦ç”¨ä¸»ç¾©ï¼šé¿å…éåº¦è¨­è¨ˆ
- æ¥­ç•Œæ¨™æº–é©—è­‰ï¼šç¬¦åˆ Google 75%+ æ¨™æº–
- é˜²é€€åŒ–æ©Ÿåˆ¶ï¼šé–€æª»ç•¥ä½æ–¼å¯¦éš›å€¼

---

**ç¶­è­·è€…**: Claude Code
**å¯©æ ¸è€…**: é–‹ç™¼åœ˜éšŠ
**ä¸‹æ¬¡å¯©æ ¸**: Q1 2025 çµæŸæ™‚
