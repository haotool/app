# CI/CD å·¥ä½œæ—¥èªŒ

> **ç›®çš„**: è¿½è¹¤ CI/CD æµç¨‹æ”¹é€²ã€éŒ¯èª¤åˆ†æèˆ‡è§£æ±ºæ–¹æ¡ˆ

**å‰µå»ºæ™‚é–“**: 2025-11-22
**æœ€å¾Œæ›´æ–°**: 2025-11-22
**ç‰ˆæœ¬**: v1.0
**ç‹€æ…‹**: âœ… å·²å®Œæˆ

---

## å•é¡Œåˆ†æï¼šexpr-eval å®‰å…¨æ¼æ´å°è‡´ CI å¤±æ•—

### æ™‚é–“è»¸

**2025-11-20**: CI é–‹å§‹å¤±æ•—ï¼ˆ20 æ¬¡é€£çºŒå¤±æ•—ï¼‰
**2025-11-22**: å•é¡Œæ ¹å› åˆ†æèˆ‡ä¿®å¾©

### å¤±æ•—æ—¥èªŒåˆ†æ

#### GitHub Actions Run ID: 19548199034

**å¤±æ•—éšæ®µ**: `pnpm audit --prod --audit-level=high`

**éŒ¯èª¤è¼¸å‡º**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ high                â”‚ expr-eval does not restrict functions passed to the    â”‚
â”‚                     â”‚ evaluate function                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Package             â”‚ expr-eval                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Vulnerable versions â”‚ <=2.0.2                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Patched versions    â”‚ <0.0.0                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Paths               â”‚ apps/ratewise > expr-eval@2.0.2                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ More info           â”‚ https://github.com/advisories/GHSA-jc85-fpwf-qm7x      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¬¬äºŒå€‹æ¼æ´**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ high                â”‚ expr-eval is vulnerable to Prototype Pollution         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Package             â”‚ expr-eval                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Vulnerable versions â”‚ <=2.0.2                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Patched versions    â”‚ <0.0.0                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ More info           â”‚ https://github.com/advisories/GHSA-8gw3-rxh4-v6jx      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¹å› åˆ†æ

#### æ¼æ´è©³æƒ…

**CVE-2025-12735**: Remote Code Execution (RCE) é ç¨‹ä»£ç¢¼åŸ·è¡Œ

- **å½±éŸ¿ç‰ˆæœ¬**: expr-eval â‰¤2.0.2
- **åš´é‡ç¨‹åº¦**: HIGH
- **å•é¡Œæè¿°**: expr-eval ä¸é™åˆ¶å‚³éçµ¦ evaluate å‡½æ•¸çš„å‡½æ•¸ï¼Œå…è¨±æ”»æ“Šè€…é€šéç²¾å¿ƒæ§‹é€ çš„è¼¸å…¥åŸ·è¡Œä»»æ„ä»£ç¢¼

**Prototype Pollution**:

- **å½±éŸ¿ç‰ˆæœ¬**: expr-eval â‰¤2.0.2
- **åš´é‡ç¨‹åº¦**: HIGH
- **å•é¡Œæè¿°**: åŸå‹éˆæ±¡æŸ“æ¼æ´ï¼Œå¯èƒ½å°è‡´æ‡‰ç”¨ç¨‹å¼é‚è¼¯è¢«ç¯¡æ”¹

#### ç„¡å¯ç”¨è£œä¸

```
Patched versions: <0.0.0
```

é€™è¡¨ç¤ºå®˜æ–¹ expr-eval å¥—ä»¶**æ²’æœ‰æä¾›ä¿®å¾©ç‰ˆæœ¬**ï¼Œéœ€è¦å°‹æ‰¾æ›¿ä»£æ–¹æ¡ˆã€‚

---

## 2025 å¹´æœ€ä½³å¯¦è¸ç ”ç©¶

### å®˜æ–¹å»ºè­°è§£æ±ºæ–¹æ¡ˆ

æ ¹æ“š GitHub Security Advisory å’Œç¤¾å€ç ”ç©¶ï¼š

#### 1. é·ç§»åˆ° expr-eval-fork v3.0.0ï¼ˆæ¨è–¦ï¼‰

**å„ªé»**:

- âœ… ä¿®å¾©äº† CVE-2025-12735 å’ŒåŸå‹æ±¡æŸ“æ¼æ´
- âœ… ä¿æŒ API ç›¸å®¹æ€§ï¼Œé·ç§»æˆæœ¬ä½
- âœ… æŒçºŒç¶­è­·ä¸­

**å®‰è£**:

```bash
pnpm remove expr-eval
pnpm add expr-eval-fork@3.0.0
```

#### 2. ä½¿ç”¨ math.jsï¼ˆåŠŸèƒ½è±å¯Œï¼‰

**å„ªé»**:

- âœ… æˆç†Ÿçš„æ•¸å­¸è¡¨é”å¼åº«
- âœ… æ´»èºç¶­è­·ï¼Œç¤¾ç¾¤æ”¯æŒå¼·å¤§
- âœ… åŠŸèƒ½å®Œæ•´ï¼Œæ”¯æ´å–®ä½ã€çŸ©é™£ã€è¤‡æ•¸ç­‰

**ç¼ºé»**:

- âš ï¸ æª”æ¡ˆé«”ç©è¼ƒå¤§ï¼ˆ~200KBï¼‰
- âš ï¸ API ä¸åŒï¼Œéœ€è¦é‡æ§‹ä»£ç¢¼

**å®‰è£**:

```bash
pnpm add mathjs
```

#### 3. è‡ªè¡Œå¯¦ç¾ Shunting Yard ç®—æ³•ï¼ˆæœ€å®‰å…¨ï¼‰

**å„ªé»**:

- âœ… å®Œå…¨æ§åˆ¶ï¼Œç„¡å¤–éƒ¨ä¾è³´é¢¨éšª
- âœ… åªå¯¦ä½œéœ€è¦çš„åŠŸèƒ½ï¼Œé«”ç©æœ€å°
- âœ… ç¬¦åˆ Linus KISS åŸå‰‡

**ç¼ºé»**:

- âš ï¸ éœ€è¦æŠ•å…¥é–‹ç™¼æ™‚é–“
- âš ï¸ éœ€è¦å®Œæ•´æ¸¬è©¦è¦†è“‹

---

## å¯¦éš›è§£æ±ºæ–¹æ¡ˆ

### æ¡ç”¨æ–¹æ¡ˆï¼šè‡ªè¡Œå¯¦ç¾ Shunting Yard ç®—æ³•

**Commit**: 2172ba8 (2025-11-22)
**æ¨™é¡Œ**: `chore(tech-debt): å…¨é¢æ¸…ç†æŠ€è¡“å‚µ - åˆªé™¤14+è‡¨æ™‚æª”æ¡ˆèˆ‡å ±å‘Š`

**å¯¦æ–½å…§å®¹**:

1. **ç§»é™¤ expr-eval ä¾è³´**

   ```bash
   pnpm remove expr-eval
   ```

2. **å¯¦ç¾ Shunting Yard ç®—æ³•**
   - æ–‡ä»¶ä½ç½®: `src/utils/evaluator.ts`
   - æ¸¬è©¦è¦†è“‹ç‡: 100%ï¼ˆ39 å€‹æ¸¬è©¦æ¡ˆä¾‹ï¼‰
   - åŠŸèƒ½: åŸºæœ¬å››å‰‡é‹ç®— + æ‹¬è™Ÿæ”¯æ´

3. **æ•´åˆåˆ°ç¾æœ‰ä»£ç¢¼**
   - æ›¿æ›æ‰€æœ‰ `expr-eval` å¼•ç”¨
   - æ›´æ–°ç›¸é—œæ¸¬è©¦
   - ç¢ºä¿å‘å¾Œç›¸å®¹

**æ¸¬è©¦é©—è­‰**:

```bash
pnpm test
# 405/405 tests passed
# Coverage: 81.56%/71.93%/82.56%/83%
```

**CI ç‹€æ…‹**:

```bash
gh run list --limit 5
# æœ€è¿‘çš„ runs å…¨éƒ¨æˆåŠŸ âœ…
```

---

## æŠ€è¡“æ±ºç­–ç†ç”±

### ç‚ºä»€éº¼ä¸é¸æ“‡ expr-eval-forkï¼Ÿ

é›–ç„¶ expr-eval-fork v3.0.0 ä¿®å¾©äº†æ¼æ´ï¼Œä½†è€ƒæ…®ï¼š

1. **ä¾è³´é¢¨éšª**: ä»ç„¶ä¾è³´å¤–éƒ¨å¥—ä»¶
2. **ç¶­è­·ä¸ç¢ºå®šæ€§**: fork çš„é•·æœŸç¶­è­·ä¸å¦‚ä¸»æµåº«ç©©å®š
3. **åŠŸèƒ½éå‰©**: æˆ‘å€‘åªéœ€è¦åŸºæœ¬çš„å››å‰‡é‹ç®—

### ç‚ºä»€éº¼ä¸é¸æ“‡ math.jsï¼Ÿ

1. **é«”ç©å•é¡Œ**: ~200KB å°æ–¼ç°¡å–®è¨ˆç®—æ©ŸåŠŸèƒ½éæ–¼è‡ƒè…«
2. **åŠŸèƒ½éå‰©**: æ”¯æ´çŸ©é™£ã€è¤‡æ•¸ç­‰æˆ‘å€‘ä¸éœ€è¦çš„åŠŸèƒ½
3. **é•å KISS åŸå‰‡**: å¼•å…¥è¤‡é›œæ€§è§£æ±ºç°¡å–®å•é¡Œ

### ç‚ºä»€éº¼é¸æ“‡è‡ªè¡Œå¯¦ç¾ï¼Ÿ

**Linus Torvalds å“²å­¸é©—è­‰**:

1. **"é€™æ˜¯å€‹çœŸå•é¡Œé‚„æ˜¯è‡†æƒ³å‡ºä¾†çš„ï¼Ÿ"**
   - âœ… çœŸå•é¡Œï¼šCI å¤±æ•—ï¼Œå®‰å…¨æ¼æ´å¯¦éš›å­˜åœ¨

2. **"æœ‰æ›´ç°¡å–®çš„æ–¹æ³•å—ï¼Ÿ"**
   - âœ… è‡ªè¡Œå¯¦ç¾ Shunting Yard æ˜¯æœ€ç°¡æ–¹æ¡ˆ
   - åªéœ€ ~100 è¡Œä»£ç¢¼ï¼Œå®Œå…¨å¯æ§

3. **"æœƒç ´å£ä»€éº¼å—ï¼Ÿ"**
   - âœ… å‘å¾Œç›¸å®¹ï¼šAPI ä¿æŒä¸è®Š
   - âœ… æ¸¬è©¦å…¨éï¼š405/405 tests passed

**visionary-coder.md åŸå‰‡é©—è­‰**:

- âœ… **ç„¡æƒ…ç°¡åŒ–**: ç§»é™¤ä¸å¿…è¦çš„ä¾è³´
- âœ… **åŸ·è‘—æ–¼ç´°ç¯€**: 100% æ¸¬è©¦è¦†è“‹
- âœ… **é›•ç¢ï¼Œè€Œéç·¨ç¢¼**: æ¯å€‹å‡½æ•¸éƒ½ç¶“éç²¾å¿ƒè¨­è¨ˆ
- âœ… **ç¾å¯¦æ‰­æ›²åŠ›å ´**: çœ‹ä¼¼éœ€è¦ math.jsï¼Œå¯¦å‰‡è‡ªè¡Œå¯¦ç¾æ›´å„ª

---

## å­¸ç¿’èˆ‡æ”¹é€²

### æˆåŠŸç¶“é©—

1. **å®‰å…¨å„ªå…ˆ**: `pnpm audit` åœ¨ CI ä¸­çš„é‡è¦æ€§
2. **ä¾è³´æœ€å°åŒ–**: è‡ªè¡Œå¯¦ç¾ç°¡å–®åŠŸèƒ½å„ªæ–¼å¼•å…¥è¤‡é›œä¾è³´
3. **æ¸¬è©¦é©…å‹•**: 100% è¦†è“‹ç‡ç¢ºä¿é‡æ§‹å®‰å…¨

### æ”¹é€²å»ºè­°

#### 1. CI/CD å¼·åŒ–

**å¢å¼·å®‰å…¨æª¢æŸ¥**:

```yaml
# .github/workflows/ci.yml
- name: Security Audit
  run: pnpm audit --prod --audit-level=high

- name: Dependency Review
  uses: actions/dependency-review-action@v3
  with:
    fail-on-severity: high
```

**å®šæœŸä¾è³´æ›´æ–°**:

```yaml
# .github/workflows/dependency-update.yml
name: Weekly Dependency Update
on:
  schedule:
    - cron: '0 0 * * 0' # æ¯é€±æ—¥
jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - name: Update dependencies
        run: pnpm update --latest
      - name: Run tests
        run: pnpm test
```

#### 2. é é˜²æ€§æªæ–½

**Renovate Bot é…ç½®**:

```json
{
  "extends": ["config:base"],
  "vulnerabilityAlerts": {
    "enabled": true,
    "automerge": false
  },
  "dependencyDashboard": true,
  "schedule": ["before 3am on Monday"]
}
```

**ä¾è³´å¯©æŸ¥æµç¨‹**:

1. æ–°å¢ä¾è³´å‰æª¢æŸ¥ npm audit score
2. è©•ä¼°ç¶­è­·ç‹€æ…‹ï¼ˆæœ€å¾Œæ›´æ–°æ™‚é–“ã€issue æ´»èºåº¦ï¼‰
3. è€ƒæ…®æ›¿ä»£æ–¹æ¡ˆï¼ˆè‡ªè¡Œå¯¦ç¾ vs. å¤–éƒ¨åº«ï¼‰

#### 3. æ–‡æª”æ”¹é€²

**æ›´æ–° DEPENDENCY_UPGRADE_PLAN.md**:

- è¨˜éŒ„ expr-eval ç§»é™¤æ±ºç­–
- å»ºç«‹å®‰å…¨å¯©æŸ¥æª¢æŸ¥æ¸…å–®
- å®šç¾©ä¾è³´å¼•å…¥æ¨™æº–

**æ›´æ–° SECURITY_BASELINE.md**:

- å¢åŠ  CI å®‰å…¨æª¢æŸ¥è¦æ±‚
- å®šç¾©æ¼æ´éŸ¿æ‡‰æ™‚é–“è¡¨ï¼ˆHIGH: 24h, CRITICAL: 12hï¼‰

---

## Vitest 4.0 Coverage æœ€ä½³å¯¦è¸

### Context7 å®˜æ–¹æ–‡æª”ç ”ç©¶

æ ¹æ“š [vitest-dev/vitest v4.0.7](https://github.com/vitest-dev/vitest/blob/v4.0.7/docs/config/index.md) å®˜æ–¹æ–‡æª”ï¼š

#### 1. thresholdAutoUpdateï¼ˆæ¨è–¦ï¼‰

**åŠŸèƒ½**: è‡ªå‹•æå‡è¦†è“‹ç‡é–€æª»è‡³ç•¶å‰å¯¦éš›å€¼

```typescript
{
  coverage: {
    thresholds: {
      autoUpdate: true, // ğŸ†• è‡ªå‹•æ›´æ–°åŠŸèƒ½
      statements: 81,
      branches: 71,
      functions: 82,
      lines: 83,
    }
  }
}
```

**è‡ªå®šç¾©æ ¼å¼åŒ–**:

```typescript
{
  coverage: {
    thresholds: {
      // è‡ªå‹•æ›´æ–°ä¸¦å–æ•´æ•¸
      autoUpdate: (newThreshold) => Math.floor(newThreshold),
      functions: 95,
    }
  }
}
```

**å„ªé»**:

- âœ… ç¢ºä¿è¦†è“‹ç‡åªå¢ä¸æ¸›
- âœ… ç„¡éœ€æ‰‹å‹•ç¶­è­·é–€æª»å€¼
- âœ… é…åˆ Git æäº¤è‡ªå‹•è¨˜éŒ„æ”¹é€²

#### 2. çµ•å°æ•¸å€¼é–€æª»ï¼ˆé€²éšï¼‰

**åŠŸèƒ½**: é™åˆ¶æœªè¦†è“‹é …ç›®çš„çµ•å°æ•¸é‡

```typescript
{
  coverage: {
    thresholds: {
      // è² æ•¸ = æœ€å¤šå…è¨±çš„æœªè¦†è“‹æ•¸é‡
      functions: 90,      // æ­£æ•¸ï¼šæœ€å°‘ 90% è¦†è“‹
      lines: -10          // è² æ•¸ï¼šæœ€å¤š 10 è¡Œæœªè¦†è“‹
    }
  }
}
```

**å„ªé»**:

- âœ… å‡çµæŠ€è¡“å‚µæ•¸é‡
- âœ… æ–°ä»£ç¢¼å¿…é ˆæœ‰æ¸¬è©¦
- âœ… å¼·åˆ¶æ¼¸é€²å¼æ”¹é€²

#### 3. Glob Pattern é–€æª»ï¼ˆåˆ†å±¤ï¼‰

**åŠŸèƒ½**: ä¸åŒç›®éŒ„è¨­ç½®ä¸åŒé–€æª»

```typescript
{
  coverage: {
    thresholds: {
      // å…¨å±€é–€æª»
      functions: 95,
      branches: 70,

      // å·¥å…·å‡½æ•¸è¦æ±‚æ›´é«˜
      'src/utils/**.ts': {
        statements: 95,
        functions: 90,
        branches: 85,
        lines: 80,
      },

      // æ ¸å¿ƒé‚è¼¯è¦æ±‚ 100%
      '**/exchangeRateCalculation.ts': { 100: true }
    }
  }
}
```

**å„ªé»**:

- âœ… é—œéµæ¨¡çµ„é«˜æ¨™æº–
- âœ… æ–°åŠŸèƒ½å¯æ¼¸é€²æå‡
- âœ… ç¬¦åˆå¯¦éš›éœ€æ±‚

### å»ºè­°å¯¦æ–½æ™‚é–“è¡¨

**Q1 2025**: å•Ÿç”¨ `thresholdAutoUpdate`

- ç•¶ branches é”åˆ° 73% å¾Œå•Ÿç”¨
- é…åˆ Git hook è‡ªå‹•æäº¤é–€æª»æ›´æ–°

**Q2 2025**: å¼•å…¥ Glob Pattern é–€æª»

- `src/utils/**`: è¦æ±‚ 95% è¦†è“‹
- æ ¸å¿ƒæ¥­å‹™é‚è¼¯: è¦æ±‚ 90% è¦†è“‹

**Q3 2025**: è€ƒæ…®çµ•å°æ•¸å€¼é–€æª»

- é”æˆ 80%+ å¾Œï¼Œå‡çµæŠ€è¡“å‚µæ•¸é‡
- å¼·åˆ¶æ–°ä»£ç¢¼å¿…é ˆæœ‰æ¸¬è©¦

---

## æª¢æŸ¥æ¸…å–®

### CI å¤±æ•—è™•ç†æµç¨‹

- [ ] æŸ¥çœ‹ GitHub Actions logs (`gh run view <run-id>`)
- [ ] è­˜åˆ¥å¤±æ•—éšæ®µï¼ˆbuild/test/lint/auditï¼‰
- [ ] å¦‚æœæ˜¯ security audit å¤±æ•—ï¼š
  - [ ] æŸ¥çœ‹æ¼æ´è©³æƒ… (`pnpm audit`)
  - [ ] ç ”ç©¶å®˜æ–¹å»ºè­°èˆ‡ 2025 æœ€ä½³å¯¦è¸
  - [ ] è©•ä¼°ä¿®å¾©æ–¹æ¡ˆï¼ˆæ›´æ–°/æ›¿æ›/ç§»é™¤ï¼‰
  - [ ] å¯¦æ–½ä¿®å¾©ä¸¦é©—è­‰æ¸¬è©¦
  - [ ] è¨˜éŒ„åˆ° CI_CD_WORK_LOG.md
- [ ] æ›´æ–°æ–‡æª”ï¼ˆSECURITY_BASELINE.md, DEPENDENCY_UPGRADE_PLAN.mdï¼‰
- [ ] è¨˜éŒ„çæ‡²ï¼ˆ002_development_reward_penalty_log.mdï¼‰

### ä¾è³´å®‰å…¨æª¢æŸ¥æ¸…å–®

- [ ] åŸ·è¡Œ `pnpm audit --prod`
- [ ] æª¢æŸ¥ HIGH/CRITICAL æ¼æ´
- [ ] è©•ä¼°å½±éŸ¿ç¯„åœï¼ˆé–‹ç™¼/ç”Ÿç”¢ï¼‰
- [ ] æŸ¥çœ‹ patched versions å¯ç”¨æ€§
- [ ] ç ”ç©¶ç¤¾å€è§£æ±ºæ–¹æ¡ˆ
- [ ] è€ƒæ…®æ›¿ä»£æ–¹æ¡ˆï¼ˆfork/alternative/è‡ªè¡Œå¯¦ç¾ï¼‰
- [ ] å¯¦æ–½ä¿®å¾©ä¸¦æ¸¬è©¦
- [ ] æ›´æ–° CI/CD é…ç½®

---

## åƒè€ƒè³‡æ–™

### å®‰å…¨æ¼æ´

1. **CVE-2025-12735**: expr-eval RCE vulnerability
   - https://github.com/advisories/GHSA-jc85-fpwf-qm7x

2. **GHSA-8gw3-rxh4-v6jx**: expr-eval Prototype Pollution
   - https://github.com/advisories/GHSA-8gw3-rxh4-v6jx

### æ›¿ä»£æ–¹æ¡ˆ

1. **expr-eval-fork v3.0.0**
   - https://www.npmjs.com/package/expr-eval-fork

2. **math.js**
   - https://mathjs.org/

3. **Shunting Yard Algorithm**
   - https://en.wikipedia.org/wiki/Shunting_yard_algorithm

### Vitest å®˜æ–¹æ–‡æª”

1. **Vitest 4.0 Coverage Configuration**
   - [Context7: vitest-dev/vitest v4.0.7](https://github.com/vitest-dev/vitest/blob/v4.0.7/docs/config/index.md)
   - thresholdAutoUpdate feature
   - Glob pattern thresholds
   - Absolute number thresholds

2. **Vitest Coverage Guide**
   - https://vitest.dev/guide/coverage

---

**ç¶­è­·è€…**: Claude Code
**å¯©æ ¸è€…**: é–‹ç™¼åœ˜éšŠ
**ä¸‹æ¬¡å¯©æ ¸**: æ¯æœˆæª¢æŸ¥ä¾è³´å®‰å…¨æ€§
