# PWA Implementation Guide

**Status**: ‚úÖ Production Ready
**Version**: 1.0.0
**Last Updated**: 2025-10-18

---

## Overview

RateWise implements Progressive Web App functionality following best practices:

- **Installable**: Meets all PWA criteria for home screen installation
- **Offline-capable**: Service Worker caching for core functionality
- **Fast**: Optimized caching strategies for instant loading
- **Secure**: HTTPS-only, proper security headers

### Architecture

- **Service Worker**: Auto-generated by vite-plugin-pwa with Workbox strategies
- **Manifest**: Complete with icons (192px - 1024px), theme colors, standalone mode
- **Caching**: NetworkFirst for API, CacheFirst for fonts/static assets

---

## Features

### Core Functionality ‚úÖ

1. **Web App Manifest** (`/manifest.webmanifest`)
   - App name, description, theme colors
   - 7 icon sizes (192px to 1024px)
   - Maskable icons for Android
   - Standalone display mode

2. **Service Worker** (auto-generated)
   - Automatic registration via vite-plugin-pwa
   - Precaching of critical assets
   - Runtime caching with Workbox strategies

3. **Caching Strategy**
   - **API** (frankfurter.app): NetworkFirst with 5min TTL
   - **Fonts** (Google Fonts): CacheFirst with 1yr TTL
   - **Static Assets**: Immutable caching with hash-based invalidation

4. **Icons & Branding**
   - 18 icon sizes from 32px to 1024px
   - Maskable icons for Android adaptive icons
   - Apple touch icons for iOS

### Future Enhancements üìã

1. **Update Notifications**: UI prompt for SW updates (when vite-plugin-pwa supports Vite 7)
2. **Push Notifications**: Requires backend VAPID server implementation
3. **Background Sync**: For offline form submissions

---

## Verification

### Build Output

```bash
pnpm --filter @app/ratewise build
```

Expected artifacts:

- `dist/sw.js` - Service Worker
- `dist/manifest.webmanifest` - PWA manifest
- All icons in `dist/` folder

### Testing

```bash
# E2E tests (includes PWA checks)
pnpm --filter @app/ratewise test:e2e

# Preview locally
pnpm --filter @app/ratewise preview
# Open http://localhost:4173/
```

### Lighthouse Audit

Run Lighthouse to verify PWA compliance:

```bash
npx lighthouse http://localhost:4173/ --view
```

Target scores:

- Performance: ‚â• 90
- Accessibility: ‚â• 90
- Best Practices: ‚â• 90
- SEO: ‚â• 90

### Real Device Testing

**iOS**:

1. Open Safari ‚Üí app.haotool.org/ratewise
2. Tap Share ‚Üí Add to Home Screen
3. Verify icon, splash screen, standalone mode

**Android**:

1. Open Chrome ‚Üí app.haotool.org/ratewise
2. Tap Menu ‚Üí Install app
3. Verify maskable icon adapts to device theme

---

## Configuration

### vite.config.ts

```typescript
import { VitePWA } from 'vite-plugin-pwa';

export default defineConfig({
  plugins: [
    VitePWA({
      registerType: 'prompt',
      manifest: {
        name: 'RateWise - Âç≥ÊôÇÂåØÁéáËΩâÊèõÂô®',
        short_name: 'RateWise',
        theme_color: '#8B5CF6',
        // ... see vite.config.ts for full config
      },
      workbox: {
        runtimeCaching: [
          {
            urlPattern: /^https:\/\/api\.frankfurter\.app\/.*/i,
            handler: 'NetworkFirst',
            options: {
              cacheName: 'frankfurter-api-cache',
              expiration: { maxAgeSeconds: 60 * 5 },
            },
          },
          // ... see vite.config.ts for full config
        ],
      },
    }),
  ],
});
```

### Environment Variables

No special environment variables required for PWA functionality.

## Troubleshooting

### Service Worker Not Registering

1. Verify HTTPS or localhost
2. Check browser console for errors
3. Clear browser cache and hard reload

### Icons Not Appearing

1. Verify all icon files exist in `/public/`
2. Check manifest.webmanifest is accessible
3. Validate icon sizes match manifest

### Caching Issues

1. Unregister old service workers
2. Clear application cache in DevTools
3. Rebuild and redeploy

## References

- [MDN - Progressive Web Apps](https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps)
- [vite-plugin-pwa Documentation](https://vite-pwa-org.netlify.app/)
- [Web.dev PWA Checklist](https://web.dev/pwa-checklist/)
- [Workbox Caching Strategies](https://developer.chrome.com/docs/workbox/caching-strategies-overview/)

---

**Maintained by**: DevOps Team | **Version**: 1.0.0
