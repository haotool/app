echo "ğŸ” Running pre-push checks..."

# [fix:2025-12-04] å„ªåŒ– pre-push hook
# æ ¹æ“šæœ€ä½³å¯¦è¸ï¼šæœ¬åœ°åƒ…åŸ·è¡Œå¿«é€Ÿæª¢æŸ¥ï¼ŒE2E/å®Œæ•´æ¸¬è©¦äº¤ç”± CI è™•ç†
# åƒè€ƒï¼šhttps://playwright.dev/docs/ci#running-tests-on-ci

# TypeScript type checking (å¿«é€Ÿï¼Œå¿…è¦)
echo "âš™ï¸  TypeScript check..."
pnpm typecheck || {
  echo "âŒ TypeScript errors found. Please fix before pushing."
  exit 1
}

# Unit tests only (å¿«é€Ÿï¼Œå¿…è¦)
# è·³é coverage æª¢æŸ¥ä»¥åŠ é€Ÿï¼ŒCI æœƒåŸ·è¡Œå®Œæ•´ coverage
echo "ğŸ§ª Running unit tests..."
pnpm test || {
  echo "âŒ Unit tests failed. Please fix before pushing."
  exit 1
}

# Build check (å¿…è¦ï¼Œç¢ºä¿å¯éƒ¨ç½²)
echo "ğŸ“¦ Build check..."
pnpm build:ratewise || {
  echo "âŒ Build failed. Please fix before pushing."
  exit 1
}

# [note] E2E tests ç§»è‡³ CI åŸ·è¡Œ
# åŸå› ï¼šE2E æ¸¬è©¦è€—æ™‚è¼ƒé•·ï¼ˆ3-5åˆ†é˜ï¼‰ï¼Œä¸é©åˆæœ¬åœ° pre-push
# CI æœƒåŸ·è¡Œå®Œæ•´ E2E + coverage + Lighthouse æª¢æŸ¥

echo "âœ… All pre-push checks passed!"
echo "ğŸ’¡ Note: E2E tests will run on CI after push."
