/**
 * 羅馬拼音轉換工具
 *
 * 此模組提供日文漢字到羅馬拼音的轉換功能。
 * 主要用於使用者自訂名字時自動產生羅馬拼音。
 *
 * 注意：此為簡易版本，使用字元對照表進行轉換。
 * 對於複雜的日文文本，建議使用 Kuroshiro 等專業庫。
 *
 * @module romajiConverter
 * @since 2025-12-06
 */

/**
 * 漢字到羅馬拼音對照表
 * 包含常見日本姓名用字
 */
const KANJI_TO_ROMAJI: Record<string, string> = {
  // 常見姓氏
  田: 'Ta',
  中: 'Naka',
  山: 'Yama',
  川: 'Kawa',
  本: 'Moto',
  木: 'Ki',
  林: 'Hayashi',
  森: 'Mori',
  村: 'Mura',
  井: 'I',
  石: 'Ishi',
  野: 'No',
  原: 'Hara',
  藤: 'Fuji',
  佐: 'Sa',
  伊: 'I',
  加: 'Ka',
  松: 'Matsu',
  竹: 'Take',
  梅: 'Ume',
  花: 'Hana',
  月: 'Tsuki',
  日: 'Hi',
  星: 'Hoshi',
  空: 'Sora',
  海: 'Umi',
  島: 'Shima',
  高: 'Taka',
  小: 'Ko',
  大: 'Ō',
  長: 'Naga',
  上: 'Ue',
  下: 'Shita',
  東: 'Higashi',
  西: 'Nishi',
  南: 'Minami',
  北: 'Kita',
  内: 'Uchi',
  外: 'Soto',
  前: 'Mae',
  後: 'Ato',
  新: 'Shin',
  古: 'Furu',
  白: 'Shiro',
  黒: 'Kuro',
  赤: 'Aka',
  青: 'Ao',
  金: 'Kin',
  銀: 'Gin',
  鉄: 'Tetsu',
  水: 'Mizu',
  火: 'Hi',
  風: 'Kaze',
  雷: 'Rai',
  雪: 'Yuki',
  桜: 'Sakura',
  菊: 'Kiku',
  蓮: 'Ren',
  葉: 'Ha',
  草: 'Kusa',
  根: 'Ne',
  枝: 'Eda',
  // 數字
  一: 'Ichi',
  二: 'Ni',
  三: 'San',
  四: 'Shi',
  五: 'Go',
  六: 'Roku',
  七: 'Nana',
  八: 'Hachi',
  九: 'Kyū',
  十: 'Jū',
  百: 'Hyaku',
  千: 'Sen',
  万: 'Man',
  // 常見名字用字
  子: 'Ko',
  男: 'Otoko',
  女: 'Onna',
  人: 'Hito',
  王: 'Ō',
  国: 'Kuni',
  城: 'Shiro',
  寺: 'Tera',
  神: 'Kami',
  仏: 'Hotoke',
  天: 'Ten',
  地: 'Chi',
  心: 'Kokoro',
  愛: 'Ai',
  美: 'Mi',
  幸: 'Sachi',
  福: 'Fuku',
  吉: 'Kichi',
  正: 'Masa',
  真: 'Ma',
  太: 'Ta',
  郎: 'Rō',
  助: 'Suke',
  介: 'Suke',
  平: 'Hei',
  治: 'Ji',
  明: 'Aki',
  光: 'Hikari',
  輝: 'Teru',
  和: 'Kazu',
  安: 'Yasu',
  康: 'Yasu',
  健: 'Ken',
  勇: 'Yū',
  智: 'Tomo',
  賢: 'Ken',
  徳: 'Toku',
  義: 'Yoshi',
  信: 'Nobu',
  忠: 'Tada',
  孝: 'Taka',
  夏: 'Natsu',
  冬: 'Fuyu',
  春: 'Haru',
  秋: 'Aki',
  朝: 'Asa',
  夜: 'Yoru',
  昼: 'Hiru',
  芙: 'Fu',
  蓉: 'Yō',
  澪: 'Mio',
  凛: 'Rin',
  翔: 'Shō',
  颯: 'Sō',
  蒼: 'Sō',
  // 諧音梗常用字
  穗: 'Sui',
  稻: 'Tō',
  宮: 'Miya',
  源: 'Gen',
  圓: 'En',
  窮: 'Kyū',
  道: 'Dō',
  穹: 'Kyū',
  睡: 'Sui',
  公: 'Kō',
  園: 'En',
  友: 'Tomo',
  芊: 'Sen',
  錢: 'Sen',
  沒: 'Bai',
  依: 'I',
  衣: 'I',
  服: 'Fuku',
  庫: 'Ku',
  褲: 'Ku',
  內: 'Nai',
  泉: 'Izumi',
  莉: 'Ri',
  卡: 'Ka',
  由: 'Yu',
  宰: 'Sai',
  具: 'Gu',
  麻: 'Ma',
  載: 'Sai',
  用: 'Yō',
  知: 'Chi',
  世: 'Yo',
  岡: 'Oka',
  門: 'Mon',
  矢: 'Ya',
  牙: 'Ga',
  佑: 'Yū',
  池: 'Ike',
  久: 'Hisa',
  武: 'Bu',
  滿: 'Man',
  壠: 'Rō',
  后: 'Go',
  粉: 'Ko',
  杏: 'An',
  谷: 'Tani',
  澤: 'Sawa',
  鈴: 'Suzu',
  舞: 'Mai',
  櫻: 'Sakura',
  京: 'Kyō',
  塚: 'Tsuka',
  杖: 'Jō',
  夕: 'Yū',
  玖: 'Ku',
  菜: 'Na',
  河: 'Kawa',
  渦: 'Ka',
  曜: 'Yō',
  犬: 'Ken',
  步: 'Ho',
  堂: 'Dō',
  乃: 'No',
  嵐: 'Arashi',
  貴: 'Taka',
  僑: 'Kyō',
  仔: 'Shi',
  裁: 'Sai',
  傅: 'Fu',
  志: 'Shi',
  戶: 'Ko',
  投: 'Tō',
  耀: 'Yō',
  布: 'Fu',
  拉: 'Ra',
  甲: 'Ka',
  熊: 'Kuma',
  政: 'Sei',
  甫: 'Fu',
  耿: 'Kō',
  痴: 'Chi',
  氣: 'Ki',
  累: 'Rui',
  肚: 'To',
  餓: 'E',
  想: 'Sō',
  覺: 'Kaku',
  無: 'Mu',
  聊: 'Ryō',
  等: 'Tō',
  緊: 'Kin',
  關: 'Kan',
  係: 'Kei',
  賀: 'Ka',
  力: 'Riki',
  雅: 'Ga',
  路: 'Ro',
  足: 'Ashi',
  甘: 'Kan',
  歹: 'Tai',
  勢: 'Sei',
  爽: 'Sō',
  快: 'Kai',
  袂: 'Bē',
  曉: 'Akira',
  講: 'Kō',
  免: 'Men',
  驚: 'Kyō',
  啦: 'Ra',
  攏: 'Rō',
  代: 'Dai',
  誌: 'Shi',
  給: 'Kyū',
  來: 'Rai',
  這: 'Sha',
  套: 'Tō',
  閉: 'Hei',
  嘴: 'Kuchi',
  是: 'Shi',
  什: 'Jū',
  麼: 'Ma',
  要: 'Yō',
  亂: 'Ran',
  話: 'Wa',
  聽: 'Chō',
  懂: 'Dō',
  死: 'Shi',
  好: 'Hō',
  喔: 'O',
  波: 'Ha',
  綺: 'Ki',
  尚: 'Shō',
  班: 'Han',
  嘉: 'Ka',
  坂: 'Saka',
  今: 'Kon',
  魚: 'Gyo',
  塊: 'Kai',
  店: 'Ten',
  賞: 'Shō',
  車: 'Sha',
  倭: 'Wa',
  帶: 'Tai',
  茶: 'Cha',
  瑤: 'Yō',
  奶: 'Nai',
  玩: 'Wan',
  油: 'Yu',
  熙: 'Ki',
  吃: 'Chi',
  帆: 'Han',
  飯: 'Han',
  糖: 'Tō',
  餅: 'Hei',
  肉: 'Niku',
  咖: 'Ka',
  啡: 'Hi',
  酒: 'Shu',
  看: 'Kan',
  買: 'Bai',
  賣: 'Bai',
  房: 'Bō',
  走: 'Sō',
  悶: 'Mon',
  打: 'Da',
  先: 'Sen',
  仙: 'Sen',
  閑: 'Kan',
  咸: 'Kan',
  再: 'Sai',
  在: 'Zai',
  補: 'Ho',
  不: 'Fu',
  妮: 'Ni',
  霓: 'Ni',
  你: 'Ni',
  她: 'Ta',
  他: 'Ta',
  塔: 'Ta',
  向: 'Kō',
  香: 'Kō',
  帥: 'Sui',
  教: 'Kyō',
  鄒: 'Sō',
  奏: 'Sō',
  亭: 'Tei',
  庭: 'Tei',
  達: 'Tatsu',
  戲: 'Gi',
  希: 'Ki',
  系: 'Kei',
  影: 'Ei',
  英: 'Ei',
  迎: 'Gei',
  灣: 'Wan',
  晚: 'Ban',
  芳: 'Hō',
  方: 'Hō',
  撤: 'Tetsu',
  徹: 'Tetsu',
  余: 'Yo',
  玉: 'Gyoku',
  雨: 'Ame',
  番: 'Ban',
  查: 'Sa',
  奈: 'Na',
  角: 'Kaku',
  麥: 'Baku',
  有: 'Yū',
  游: 'Yū',
  遊: 'Yū',
  祐: 'Yū',
  侑: 'Yū',
  悠: 'Yū',
  裕: 'Yū',
  優: 'Yū',
  // 更多常用字
  坊: 'Bō',
  屋: 'Oku',
  重: 'Jū',
  經: 'Kei',
  箱: 'Hako',
  涼: 'Ryō',
  炒: 'Chō',
  藥: 'Yaku',
  趁: 'Chin',
  早: 'Sō',
  栗: 'Kuri',
  宏: 'Kō',
  柑: 'Kan',
  玲: 'Rei',
  露: 'Tsuyu',
  邊: 'Hen',
  停: 'Tei',
  憲: 'Ken',
  樹: 'Ki',
  段: 'Dan',
  式: 'Shiki',
  左: 'Sa',
  転: 'Ten',
  皇: 'Kō',
  登: 'Tō',
  粟: 'Awa',
  黃: 'Kō',
  燈: 'Tō',
  兆: 'Chō',
  象: 'Shō',
  照: 'Shō',
  相: 'Sō',
  邈: 'Byō',
  茄: 'Ka',
  秒: 'Byō',
  慧: 'Kei',
  卓: 'Taku',
  仁: 'Jin',
  鶴: 'Tsuru',
  會: 'Kai',
  啄: 'Taku',
  亀: 'Kame',
  龜: 'Kame',
  那: 'Na',
  飼: 'Shi',
  悟: 'Go',
  零: 'Rei',
  去: 'Kyo',
  兵: 'Hei',
  辣: 'Ra',
  薩: 'Sa',
  咪: 'Mi',
  呀: 'Ya',
  奥: 'Oku',
  淚: 'Rui',
  音: 'On',
  娜: 'Na',
  瀧: 'Taki',
  宗: 'Sō',
  稀: 'Ki',
  哲: 'Tetsu',
  利: 'Ri',
  休: 'Kyū',
  部: 'Bu',
  淺: 'Asa',
  晴: 'Sei',
  淨: 'Jō',
  口: 'Kuchi',
  督: 'Toku',
  史: 'Shi',
  渡: 'Wata',
  次: 'Ji',
  卷: 'Maki',
  倦: 'Ken',
  富: 'Tomi',
  伸: 'Shin',
  紀: 'Ki',
  琴: 'Koto',
  遲: 'Chi',
  淮: 'Wai',
  杞: 'Ki',
  秀: 'Shū',
  莹: 'Ei',
  景: 'Kei',
  名: 'Na',
  仰: 'Gyō',
  耕: 'Kō',
  种: 'Shu',
  竖: 'Jū',
  龙: 'Ryū',
  夫: 'Fu',
  良: 'Ryō',
  合: 'Gō',
  瓦: 'Ga',
  搭: 'Ta',
  哇: 'Wa',
  修: 'Shū',
  報: 'Hō',
  學: 'Gaku',
  士: 'Shi',
  亞: 'A',
  鍋: 'Nabe',
  橋: 'Hashi',
  喜: 'Ki',
  稲: 'Ina',
  姫: 'Hime',
  萬: 'Man',
  毛: 'Mō',
  熱: 'Netsu',
  爛: 'Ran',
  瑜: 'Yu',
  充: 'Jū',
  庶: 'Sho',
  芒: 'Bō',
  果: 'Ka',
  沖: 'Oki',
  浩: 'Kō',
  里: 'Ri',
  拍: 'Haku',
  軌: 'Ki',
  鬼: 'Ki',
  辻: 'Tsuji',
  慘: 'San',
  鷲: 'Washi',
  棟: 'Tō',
  桃: 'Momo',
  昭: 'Shō',
  龍: 'Ryū',
  也: 'Ya',
  整: 'Sei',
  // 平假名
  あ: 'a',
  い: 'i',
  う: 'u',
  え: 'e',
  お: 'o',
  か: 'ka',
  き: 'ki',
  く: 'ku',
  け: 'ke',
  こ: 'ko',
  さ: 'sa',
  し: 'shi',
  す: 'su',
  せ: 'se',
  そ: 'so',
  た: 'ta',
  ち: 'chi',
  つ: 'tsu',
  て: 'te',
  と: 'to',
  な: 'na',
  に: 'ni',
  ぬ: 'nu',
  ね: 'ne',
  の: 'no',
  は: 'ha',
  ひ: 'hi',
  ふ: 'fu',
  へ: 'he',
  ほ: 'ho',
  ま: 'ma',
  み: 'mi',
  む: 'mu',
  め: 'me',
  も: 'mo',
  や: 'ya',
  ゆ: 'yu',
  よ: 'yo',
  ら: 'ra',
  り: 'ri',
  る: 'ru',
  れ: 're',
  ろ: 'ro',
  わ: 'wa',
  を: 'wo',
  ん: 'n',
  // 片假名
  ア: 'a',
  イ: 'i',
  ウ: 'u',
  エ: 'e',
  オ: 'o',
  カ: 'ka',
  キ: 'ki',
  ク: 'ku',
  ケ: 'ke',
  コ: 'ko',
  サ: 'sa',
  シ: 'shi',
  ス: 'su',
  セ: 'se',
  ソ: 'so',
  タ: 'ta',
  チ: 'chi',
  ツ: 'tsu',
  テ: 'te',
  ト: 'to',
  ナ: 'na',
  ニ: 'ni',
  ヌ: 'nu',
  ネ: 'ne',
  ノ: 'no',
  ハ: 'ha',
  ヒ: 'hi',
  フ: 'fu',
  ヘ: 'he',
  ホ: 'ho',
  マ: 'ma',
  ミ: 'mi',
  ム: 'mu',
  メ: 'me',
  モ: 'mo',
  ヤ: 'ya',
  ユ: 'yu',
  ヨ: 'yo',
  ラ: 'ra',
  リ: 'ri',
  ル: 'ru',
  レ: 're',
  ロ: 'ro',
  ワ: 'wa',
  ヲ: 'wo',
  ン: 'n',
};

/**
 * 將日文文字轉換為羅馬拼音
 *
 * @param text - 要轉換的日文文字（漢字、平假名、片假名）
 * @returns 轉換後的羅馬拼音
 *
 * @example
 * ```ts
 * convertToRomaji('梅川伊芙'); // 'Umekawa Ifu'
 * convertToRomaji('田中太郎'); // 'Tanaka Tarō'
 * ```
 */
export function convertToRomaji(text: string): string {
  if (!text) return '';

  let result = '';
  for (const char of text) {
    result += KANJI_TO_ROMAJI[char] ?? char;
  }

  // 首字母大寫，其餘小寫
  return result
    .split(' ')
    .map((word) => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())
    .join(' ');
}

/**
 * 檢查文字是否包含日文字元
 *
 * @param text - 要檢查的文字
 * @returns 是否包含日文字元
 */
export function containsJapanese(text: string): boolean {
  // 平假名: \u3040-\u309F
  // 片假名: \u30A0-\u30FF
  // 漢字: \u4E00-\u9FFF
  return /[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FFF]/.test(text);
}

/**
 * 取得羅馬拼音對照表的字元數
 */
export function getRomajiDictionarySize(): number {
  return Object.keys(KANJI_TO_ROMAJI).length;
}

export default convertToRomaji;
